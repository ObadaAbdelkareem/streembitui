
<div data-bind="foreach: iothubs" class="row" style="margin:0">        
    <div class="col-md-12 iothub">
        <div class="iothub-header">
            <div class="pull-left" style="padding:5px 0 0 10px;"><i class="fa fa-tasks fa-lg"></i>&nbsp;&nbsp;&nbsp;<span data-bind="text:name"></span></div>
            <div class="btn-group display-inline pull-right text-align-left hidden-tablet" style="padding:6px 5px 5px 0">
                <button class="btn btn-xs btn-default" data-bind="click: refresh">
                    <i class="fa fa-refresh fa-lg"></i>
                </button>
                <button class="btn btn-xs btn-default" data-bind="click: toggle_shownetwork_info">
                    <i class="fa fa-info-circle fa-lg"></i>
                </button>
                <button class="btn btn-xs btn-default" data-bind="click: edit_hub">
                    <i class="fa fa-cog fa-lg"></i>
                </button>
                <button class="btn btn-xs btn-default" data-bind="click: add_device">
                    <i class="fa fa-plus-circle fa-lg"></i>
                </button>
                <button class="btn btn-xs btn-default" data-bind="click: $component.removehub">
                    <i class="fa fa-remove fa-lg"></i>
                </button>
            </div>
            <div style="clear:both"></div>
        </div>
        <div data-bind="template: network_info_template" style="position:relative">
        </div>
        <!--<div class="iothub-details" data-bind="visible: !isedit_mode()">
            <table>
                <tr>
                    <td><span class="title">ID:</span></td>
                    <td><span class="data" data-bind="text:id"></span></td>
                </tr>
                <tr>
                    <td><span class="title">Public key: </span></td>
                    <td><span class="data" data-bind="text:publickey"></span></td>
                </tr>
            </table>
        </div>-->
        <div data-bind="template: template_name">
        </div>

        <div data-bind="foreach: iotdevices" class="row" style="margin:0">
            <div class="col-md-3 iothub-iotdevice-frame">
                <div class="iothub-iotdevice">
                    <div class="title">
                        <div class="pull-left" style="padding: 6px 5px 5px 5px;"><span data-bind="text: name"></span></div>
                        <div class="btn-group display-inline pull-right text-align-left hidden-tablet" style="padding:6px 5px 5px 0">                            
                            <button class="btn btn-xs btn-default" data-bind="click: refresh">
                                <i class="fa fa-refresh fa-lg"></i>
                            </button>
                            <button class="btn btn-xs btn-default" data-bind="click: toggle_shownetwork_info">
                                <i class="fa fa-info-circle fa-lg"></i>
                            </button>
                            <button class="btn btn-xs btn-default" data-bind="click: edit_device">
                                <i class="fa fa-cog fa-lg"></i>
                            </button>
                            <button class="btn btn-xs btn-default" data-bind="click: function(){ $parent.delete_device($data, $parent); }">
                                <i class="fa fa-remove fa-lg"></i>
                            </button>
                        </div>
                        <div style="clear:both"></div>
                    </div>
                    <div data-bind="template: network_info_template" style="position:relative">
                    </div>
                    <div data-bind="template: template_name" class="iothub-iotdevice-details">

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Feature specific templates -->
<script type="text/html" id="feature-receiving-data">
    <div class="data-notreceived-info">
        <span class="inactive-device-info">Receiving data ...</span>
    </div>
</script>

<script type="text/html" id="feature-inactive-device">
    <div class="data-notreceived-info">
        <span class="inactive-device-info">Device is inactive ...</span>
    </div>
</script>

<script type="text/html" id="feature-on-off-switch">
    <div style="display: flex;width: 100%;justify-content: center">
        <div class="onoffswitch" style="margin:15px">
            <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch" data-bind="switchbtn: ctrlstatus">
            <label class="onoffswitch-label" for="myonoffswitch">
                <span class="onoffswitch-inner"></span>
                <span class="onoffswitch-switch"></span>
            </label>
        </div>
        <div style="clear:both"></div>
    </div>  
</script>

<script type="text/html" id="feature-electric-measurement">
    <div style="padding:10px;text-align:center">
        <div>
            Power consumption: <span data-bind="text: power_consumption"></span> Watt
        </div>
        <div>
            Voltage: <span data-bind="text: voltage"></span> Volt
        </div>
    </div>
</script>

<script type="text/html" id="feature-temperature-measurement">
    <div style="margin:15px 0">
        <div style="position: relative;">
            <div class="temperature">
                <i class="fa fa-thermometer-three-quarters fa-5" style="color:#aaa"></i>&nbsp;<span data-bind="text: integral">1</span><span class="decimal">.</span><span class="decimal" data-bind="text: decimal">9</span><strong>&deg;</strong>
            </div>
        </div>
    </div>
</script>

<script type="text/html" id="feature-relhumidity-measurement">
    <div>
        Relative Humidity Measurement
    </div>
</script>

<script type="text/html" id="feature-occupancy-sensing">
    <div>
        Occupancy Sensing
    </div>
</script>

<script type="text/html" id="feature-template">
    <div data-bind="template: template_name">        
    </div>        
</script>


<script type="text/html" id="features-template">
    <div data-bind="foreach: features">
        <div class="device-feature-item" data-bind="template: {name: 'feature-template' }">           
        </div>
    </div>
</script>


<script type="text/html" id="gateway-info-template">
    <div class="device-net-info" style="right:25px;top:3px" data-bind="click: toggle_shownetwork_info">
        <table>
            <tr><td>Device ID: </td> <td data-bind="text: id"></td></tr>
            <tr><td>Network: </td> <td data-bind="text: networkinfo.platform"></td></tr>
            <tr><td>Manufacturer: </td> <td data-bind="text: networkinfo.manufacturername"></td></tr>
            <tr><td>Model: </td> <td data-bind="text: networkinfo.modelidentifier"></td></tr>
            <tr><td>Hardware version: </td> <td data-bind="text: networkinfo.hwversion"></td></tr>
            <tr><td>Protocol: </td> <td data-bind="text: networkinfo.protocol"></td></tr>
            <tr><td>Security: </td> <td data-bind="text: networkinfo.security"></td></tr>
            <tr><td>Secure_hardware: </td> <td data-bind="text: networkinfo.secure_hardware"></td></tr>
            <tr><td>MCU Address64: </td> <td data-bind="text: networkinfo.address64"></td></tr>
            <tr><td>MCU Address16: </td> <td data-bind="text: networkinfo.address16"></td></tr>
            <tr><td>Public key: </td> <td data-bind="text: publickey"></td></tr>
        </table>
    </div>
</script>

<script type="text/html" id="zigbee-info-template">
    <div class="device-net-info" data-bind="click: $parent.toggle_shownetwork_info">
        <table>
            <tr><td>Manufacturer: </td> <td data-bind="text: networkinfo.manufacturername"></td></tr>
            <tr><td>Model: </td> <td data-bind="text: networkinfo.modelidentifier"></td></tr>
            <tr><td>Hardware version: </td> <td data-bind="text: networkinfo.hwversion"></td></tr>
            <tr><td>Network: </td> <td>Zigbee</td></tr>
            <tr><td>Address64: </td> <td data-bind="text: networkinfo.address64"></td></tr>
            <tr><td>Address16: </td> <td data-bind="text: networkinfo.address16"></td></tr>            
            <!--<tr><td>Iddle enabled: </td> <td data-bind="text: networkinfo.iddle_enable"></td></tr>
            <tr><td>Relationship: </td> <td data-bind="text: networkinfo.relationship"></td></tr>
            <tr><td>Permit join: </td> <td data-bind="text: networkinfo.permitjoin"></td></tr>
            <tr><td>Depth: </td> <td data-bind="text: networkinfo.depth"></td></tr>
            <tr><td style="border-bottom-width:0">LQI: </td> <td style="border-bottom-width:0" data-bind="text: networkinfo.lqi"></td></tr>-->
        </table>
    </div>
</script>

<script type="text/html" id="zwave-info-template">
    <div class="device-net-info">
        Z-Wave net info
    </div>
</script>

<script type="text/html" id="slowpan-info-template">
    <div class="device-net-info">
        6LowPAN net info
    </div>
</script>


<script type="text/html" id="smart_plug_device">
    <div class="onoff_switch">
        <div style="display:flex;flex-direction: row">
            <div style="flex-grow:1">
                <div class="onoffswitch">
                    <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch" data-bind="switchbtn: ctrlstatus">
                    <label class="onoffswitch-label" for="myonoffswitch">
                        <span class="onoffswitch-inner"></span>
                        <span class="onoffswitch-switch"></span>
                    </label>
                </div>
            </div>
            <div style="flex-grow:1">
                <div style="padding-top: 12px;">
                    Device reported status: <span data-bind="text: statustext" style="font-weight:bold"></span>
                </div>
            </div>
        </div>

        <div>
            <span>Power consumption: </span> <span data-bind="text: power_consumption"></span>
        </div>
        <div>
            <span>Voltage: </span> <span data-bind="text: voltage"></span>
        </div>
    </div>
</script>

<script type="text/html" id="smart_plug_device_settings">
    <div class="form-group" style="margin-bottom:20px">
        <div>Device type: <span style="font-weight:bold">ON/OFF switch</span></div>
    </div>
    <div class="form-group" style="margin-bottom:20px">
        <label>Refresh interval</label>
        <input class="form-control" type="number" min="30000" max="3600000" data-bind="value: refresh_interval" style="max-width:150px">
        <div data-bind="visible: is_interval_error">
            <em id="id-error" class="invalid error-label">A valid number is required between 30,000 and 3,600,000.</em>
        </div>
    </div>
</script>

<script type="text/html" id="onoff_switch_device">    
    <div class="onoff_switch">
        <div style="display:flex;flex-direction: row">
            <div style="flex-grow:1">
                <div class="onoffswitch">
                    <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch" data-bind="switchbtn: ctrlstatus" >
                    <label class="onoffswitch-label" for="myonoffswitch">
                        <span class="onoffswitch-inner"></span>
                        <span class="onoffswitch-switch"></span>
                    </label>
                </div>
            </div>
            <div  style="flex-grow:1">
                <div style="padding-top: 12px;">
                    Device reported status: <span data-bind="text: statustext" style="font-weight:bold"></span>
                </div>
            </div>
        </div>
        
        <div>    
            <span>Power consumption: </span> <span data-bind="text: power_consumption"></span>
        </div>
        <div>
            <span>Voltage: </span> <span data-bind="text: voltage"></span>
        </div>
    </div>    
</script>

<script type="text/html" id="onoff_switch_device_settings">
    <div class="form-group" style="margin-bottom:20px">
        <div>Device type: <span style="font-weight:bold">ON/OFF switch</span></div>
    </div>
    <div class="form-group" style="margin-bottom:20px">
        <label>Refresh interval</label>
        <input class="form-control" type="number" min="30000" max="3600000" data-bind="value: refresh_interval" style="max-width:150px">
        <div data-bind="visible: is_interval_error">
            <em id="id-error" class="invalid error-label">A valid number is required between 30,000 and 3,600,000.</em>
        </div>
    </div>
</script>

<script type="text/html" id="add_device">
    <div data-bind="component:{name: 'addiotdevice', params: $data}">
    </div>
</script>

<script type="text/html" id="edit_hub">
    <div class="row" style="margin:0; padding:0">
        <article class="col-sm-12 col-md-12 col-lg-6">
            <div style="border: 1px dotted #ccc;padding:0;margin-top:20px;margin-bottom:30px">
                <form class="form-horizontal iothub-form">
                    <fieldset>
                        <legend>Edit Hub</legend>
                        <div class="padding: 0">
                            <div class="form-group">
                                <label>Hub ID</label>
                                <div>
                                    <span data-bind="text: id" style="font-weight:bold"></span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Hub name</label>
                                <input class="form-control" placeholder="Hub name" type="text" data-bind="value: newname">
                                <div data-bind="visible: is_newname_error">
                                    <em id="id-error" class="invalid error-label">This field is required.</em>
                                </div>
                            </div>
                            <div class="form-group" style="margin-bottom:20px">
                                <label>Public key</label>
                                <input class="form-control" placeholder="BS58 encoded public key" type="text" data-bind="value: newpublickey">
                                <div data-bind="visible: is_newid_error">
                                    <em id="id-error" class="invalid error-label">This field is required.</em>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    <div class="form-actions">
                        <div class="row" style="margin:0">
                            <div class="col-md-12">
                                <button class="btn btn-default" data-bind="click: cancel_edit_hub">
                                    Cancel
                                </button>
                                <button class="btn btn-primary" data-bind="click: submit_edit_hub">
                                    <i class="fa fa-save"></i>
                                    Update Hub
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </article>
    </div>
</script>

<script type="text/html" id="edit_device">
    <div class="row" style="margin:0; padding:0">
        <article class="col-sm-12 col-md-12">
            <div style="border: 1px dotted #ccc;padding:0;margin-top:5px;margin-bottom:5px">
                <form class="form-horizontal iothub-form">
                    <fieldset>
                        <legend>Edit Device</legend>
                        <div class="padding: 0">
                            <div class="form-group">
                                <label>Device ID</label>
                                <input class="form-control" placeholder="The MAC of your Zigbee/Z-wave/6LowPan device" type="text" data-bind="value: newid">
                                <div data-bind="visible: is_newid_error">
                                    <em id="id-error" class="invalid error-label">The ID field is required.</em>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Device name</label>
                                <input class="form-control" placeholder="Device name" type="text" data-bind="value: newname">
                                <div data-bind="visible: is_newname_error">
                                    <em id="id-error" class="invalid error-label">The name field is required.</em>
                                </div>
                            </div>
                            <div>
                                <!--data-bind="template: features_template"-->
                            </div>
                        </div>
                    </fieldset>
                    <div class="form-actions">
                        <div class="row" style="margin:0">
                            <div class="col-md-12">
                                <button class="btn btn-default" data-bind="click: cancel_edit">
                                    Cancel
                                </button>
                                <button class="btn btn-primary" data-bind="click: function(){ $parent.submit_edit_device($data, $parent); }">
                                    <i class="fa fa-save"></i>
                                    Update Device
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </article>
    </div>
</script>